function [d2c_duv0,dc_du0,dc_dv0] = vder(Fhat,alpha,copula)
%UNTITLED Summary of this function goes here
%   Detailed explanation goes here
d2c_duv0=zeros();dc_du0=zeros();dc_dv0=zeros();
N=length(Fhat(:,1));
if copula=='G1'        % Gumbel copula
% syms u v alpha1
% f=exp(-(((-log(u))^(alpha1)+((-log(v))^(alpha1))))^(1/alpha1));
% dc=diff(diff(f,u), v);  
% d2c_duv= @(u,v,alpha1) (exp(-((-log(u)).^(6/5) + (-log(v))^(6/5)).^(5/6))*(-log(u)).^(1/5)*(-log(v)).^(1/5))/(u.^2*v.^2*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(1/3)) - (exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5))^(5/6))*(-log(u)).^(1/5)*(-log(v)).^(2/5))/(u.^2*v.^2*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(1/2)) - (exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6))*(-log(u)).^(2/5)*(-log(v)).^(1/5))/(u.^2*v.^2*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(1/2)) + (exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6))*(-log(u)).^(1/5))/(5*u.^2*v.^2*(-log(v)).^(4/5)*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(1/3)) + (6*exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6))*(-log(u)).^(2/5)*(-log(v)).^(2/5))/(5*u.^2*v.^2*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(3/2)) + (exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6))*(-log(u)).^(2/5)*(-log(v)).^(2/5))/(u.^2*v.^2*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(2/3)) - (exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6))*(-log(u)).^(2/5))/(5*u.^2*v.^2*(-log(v)).^(4/5)*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(1/2)) + (exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6)).*(-log(v)).^(1/5))/(5*u.^2*v.^2.*(-log(u)).^(4/5).*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(1/3)) - (exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6)).*(-log(v)).^(2/5))/(5.*u.^2.*v^2.*(-log(u)).^(4/5).*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(1/2)) - (3.*exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6)).*(-log(u)).^(1/5).*(-log(v)).^(2/5))./(5*u.^2.*v.^2.*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(4/3)) - (3.*exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6)).*(-log(u)).^(2/5).*(-log(v)).^(1/5))./(5.*u.^2.*v.^2.*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(4/3)) + exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6))./(25.*u.^2.*v.^2.*(-log(u)).^(4/5).*(-log(v)).^(4/5).*((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(1/3)) - (3.*exp(-((-log(u)).^(6/5) + (-log(v)).^(6/5)).^(5/6)).*(-log(u)).^(2/5))/(25*u^2*v^2*(-log(v))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(4/3)) - (3*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(v))^(2/5))/(25*u^2*v^2*(-log(u))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(4/3)) + (31*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(2/5)*(-log(v))^(2/5))/(25*u^2*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(7/3)) + (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5)*(-log(v))^(1/5))/(5*u^2*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(7/6)) + (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5))/(25*u^2*v^2*(-log(v))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(7/6)) + (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(v))^(1/5))/(25*u^2*v^2*(-log(u))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(7/6)) + exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))/(125*u^2*v^2*(-log(u))^(4/5)*(-log(v))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(7/6)) - (7*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5)*(-log(v))^(2/5))/(25*u^2*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(13/6)) - (7*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(2/5)*(-log(v))^(1/5))/(25*u^2*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(13/6)) - (7*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(2/5))/(125*u^2*v^2*(-log(v))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(13/6)) - (7*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(v))^(2/5))/(125*u^2*v^2*(-log(u))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(13/6)) + (91*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(2/5)*(-log(v))^(2/5))/(125*u^2*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(19/6));
d2c_duv= @(u,v,alpha1) (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(4/alpha1 - 4))/(u^2*v^2) + (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2))/(u^2*v^2) + (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*(alpha1 - 1))/(u^2*v^2) + (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*(alpha1 - 1))/(u^2*v^2) + (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*(alpha1 - 1)^2)/(u^2*v^2) - (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(2*alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1))/(u^2*v^2) - (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1))/(u^2*v^2) + (alpha1^2*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)^2*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 4))/(u^2*v^2) - (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*(alpha1 - 1))/(u^2*v^2) - (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*(alpha1 - 1))/(u^2*v^2) - (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 1)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2))/(u^2*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(2*alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 3)*(2/alpha1 - 2))/(u^2*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 3)*(2/alpha1 - 2))/(u^2*v^2) - (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 2)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2)*(alpha1 - 1))/(u^2*v^2) - (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(alpha1 - 1)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2)*(alpha1 - 1))/(u^2*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 3)*(2/alpha1 - 2)*(alpha1 - 1))/(u^2*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 3)*(2/alpha1 - 2)*(alpha1 - 1))/(u^2*v^2) - (alpha1^2*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)*(1/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 3))/(u^2*v^2) - (alpha1^2*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 1)*(1/alpha1 - 1)*(1/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 3))/(u^2*v^2) - (2*alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2))/(u^2*v^2) - (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(alpha1 - 2)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2)*(alpha1 - 1)^2)/(u^2*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2))/(u^2*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 1)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2))/(u^2*v^2) + (alpha1^2*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 4)*(2/alpha1 - 2)*(2/alpha1 - 3))/(u^2*v^2) - (2*alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 3)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*(2/alpha1 - 2))/(u^2*v^2) - (alpha1^2*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)*(1/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 3)*(alpha1 - 1))/(u^2*v^2) - (alpha1^2*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 2)*(1/alpha1 - 1)*(1/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 3)*(alpha1 - 1))/(u^2*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2)*(alpha1 - 1))/(u^2*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 2)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2)*(alpha1 - 1))/(u^2*v^2) + (2*alpha1^2*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)*(1/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 3))/(u^2*v^2) - (alpha1^3*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)*(1/alpha1 - 2)*(1/alpha1 - 3)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 4))/(u^2*v^2);

% dc_du= @(u,v,alpha1) (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(2/5)*(-log(v))^(1/5))/(u^2*v*((-log(u))^(6/5) + (-log(v))^(6/5))^(1/2)) - (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5)*(-log(v))^(1/5))/(u^2*v*((-log(u))^(6/5) + (-log(v))^(6/5))^(1/3)) - (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(v))^(1/5))/(5*u^2*v*(-log(u))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(1/3)) + (3*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(2/5)*(-log(v))^(1/5))/(5*u^2*v*((-log(u))^(6/5) + (-log(v))^(6/5))^(4/3)) - (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5)*(-log(v))^(1/5))/(5*u^2*v*((-log(u))^(6/5) + (-log(v))^(6/5))^(7/6)) - (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(v))^(1/5))/(25*u^2*v*(-log(u))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(7/6)) + (7*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(2/5)*(-log(v))^(1/5))/(25*u^2*v*((-log(u))^(6/5) + (-log(v))^(6/5))^(13/6));
dc_du= @(u,v,alpha1) (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1))/(u^2*v) - (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*(alpha1 - 1))/(u^2*v) - (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2))/(u^2*v) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 1)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2))/(u^2*v) - (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 3)*(2/alpha1 - 2))/(u^2*v) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 2)*(-log(v))^(alpha1 - 1)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2)*(alpha1 - 1))/(u^2*v) + (alpha1^2*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 1)*(1/alpha1 - 1)*(1/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 3))/(u^2*v) - (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(2*alpha1 - 2)*(-log(v))^(alpha1 - 1)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2))/(u^2*v);

% dc_dv= @(u,v,alpha1)  (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5)*(-log(v))^(2/5))/(u*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(1/2)) - (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5)*(-log(v))^(1/5))/(u*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(1/3)) - (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5))/(5*u*v^2*(-log(v))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(1/3)) + (3*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5)*(-log(v))^(2/5))/(5*u*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(4/3)) - (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5)*(-log(v))^(1/5))/(5*u*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(7/6)) - (exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5))/(25*u*v^2*(-log(v))^(4/5)*((-log(u))^(6/5) + (-log(v))^(6/5))^(7/6)) + (7*exp(-((-log(u))^(6/5) + (-log(v))^(6/5))^(5/6))*(-log(u))^(1/5)*(-log(v))^(2/5))/(25*u*v^2*((-log(u))^(6/5) + (-log(v))^(6/5))^(13/6));
 dc_dv= @(u,v,alpha1)  (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(2*alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1))/(u*v^2) - (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2)*(alpha1 - 1))/(u*v^2) - (exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 2))/(u*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 1)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2))/(u*v^2) - (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(2*alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(2/alpha1 - 3)*(2/alpha1 - 2))/(u*v^2) + (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(alpha1 - 2)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2)*(alpha1 - 1))/(u*v^2) + (alpha1^2*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)*(1/alpha1 - 2)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 3))/(u*v^2) - (alpha1*exp(-((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1))*(-log(u))^(alpha1 - 1)*(-log(v))^(2*alpha1 - 2)*(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 1)*((-log(u))^alpha1 + (-log(v))^alpha1)^(1/alpha1 - 2))/(u*v^2);

 
elseif copula=='G2'     %Gaussian
  % syms u v alpha1
% f= 1 / sqrt(1 - alpha^2) * exp(-((alpha^2*(u^2+v^2)-2*alpha*u*v)/(2*(1-alpha^2))));
% dc=diff(diff(f,u), v);
 d2c_duv= @(u,v,alpha1)  (exp((alpha^2*(u^2 + v^2) - 2*alpha*u*v)/(2*alpha^2 - 2))*(- 2*v*alpha^2 + 2*u*alpha)*(- 2*u*alpha^2 + 2*v*alpha))/((1 - alpha^2)^(1/2)*(2*alpha^2 - 2)^2) - (2*alpha*exp((alpha^2*(u^2 + v^2) - 2*alpha*u*v)/(2*alpha^2 - 2)))/((1 - alpha^2)^(1/2)*(2*alpha^2 - 2));
 dc_du= @(u,v,alpha1) -(exp((alpha^2*(u^2 + v^2) - 2*alpha*u*v)/(2*alpha^2 - 2))*(- 2*u*alpha^2 + 2*v*alpha))/((1 - alpha^2)^(1/2)*(2*alpha^2 - 2));
 dc_dv= @(u,v,alpha1) -(exp((alpha^2*(u^2 + v^2) - 2*alpha*u*v)/(2*alpha^2 - 2))*(- 2*v*alpha^2 + 2*u*alpha))/((1 - alpha^2)^(1/2)*(2*alpha^2 - 2));
 
elseif copula=='C'    %Clayton
% syms u v alpha1
% f=((u)^max((-alpha1)+(v)^(-alpha1)-1)^(-1/alpha1),0);
% dc=diff(diff(f,u), v);
d2c_duv= @(u,v,alpha1) max((alpha1*(1/alpha1 + 1))/(u^(alpha1 + 1)*v^(alpha1 + 1)*(1/u^alpha1 + 1/v^alpha1 - 1)^(1/alpha1 + 2)),0);
 dc_du= @(u,v,alpha1) max([(alpha1^2*(1/alpha1 + 1)*(1/alpha1 + 2))/(u^(2*alpha1 + 2)*v^(alpha1 + 1)*(1/u^alpha1 + 1/v^alpha1 - 1)^(1/alpha1 + 3)) - (alpha1*(1/alpha1 + 1)*(alpha1 + 1))/(u^(alpha1 + 2)*v^(alpha1 + 1)*(1/u^alpha1 + 1/v^alpha1 - 1)^(1/alpha1 + 2)) 0]);
 dc_dv= @(u,v,alpha1) max([(alpha1^2*(1/alpha1 + 1)*(1/alpha1 + 2))/(u^(alpha1 + 1)*v^(2*alpha1 + 2)*(1/u^alpha1 + 1/v^alpha1 - 1)^(1/alpha1 + 3)) - (alpha1*(1/alpha1 + 1)*(alpha1 + 1))/(u^(alpha1 + 1)*v^(alpha1 + 2)*(1/u^alpha1 + 1/v^alpha1 - 1)^(1/alpha1 + 2)) 0]);
    
elseif copula=='F'   %Frank
% syms u v alpha1
% f=(-1/alpha1)*log(1+((exp(-alpha1*u-1)*exp(-alpha1*v-1))/(exp(-alpha1)-1)));
% dc=diff(diff(f,u), v);
d2c_duv= @(u,v,alpha1) (7*alpha1^3*exp(- 2*alpha1*u - 2)*exp(- 2*alpha1*v - 2))/((exp(-alpha1) - 1)^2*((exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/(exp(-alpha1) - 1) + 1)^2) - (alpha1^3*exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/((exp(-alpha1) - 1)*((exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/(exp(-alpha1) - 1) + 1)) + (6*alpha1^3*exp(- 4*alpha1*u - 4)*exp(- 4*alpha1*v - 4))/((exp(-alpha1) - 1)^4*((exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/(exp(-alpha1) - 1) + 1)^4) - (12*alpha1^3*exp(- alpha1*u - 1)*exp(- 2*alpha1*u - 2)*exp(- alpha1*v - 1)*exp(- 2*alpha1*v - 2))/((exp(-alpha1) - 1)^3*((exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/(exp(-alpha1) - 1) + 1)^3);  
dc_du= @(u,v,alpha1) (alpha1*exp(- 2*alpha1*u - 2)*exp(- 2*alpha1*v - 2))/((exp(-alpha1) - 1)^2*((exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/(exp(-alpha1) - 1) + 1)^2) - (alpha1*exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/((exp(-alpha1) - 1)*((exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/(exp(-alpha1) - 1) + 1));

dc_dv= @(u,v,alpha1) (alpha1*exp(- 2*alpha1*u - 2)*exp(- 2*alpha1*v - 2))/((exp(-alpha1) - 1)^2*((exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/(exp(-alpha1) - 1) + 1)^2) - (alpha1*exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/((exp(-alpha1) - 1)*((exp(- alpha1*u - 1)*exp(- alpha1*v - 1))/(exp(-alpha1) - 1) + 1));

end  


for n=1:N
d2c_duv0(n,1)=d2c_duv(Fhat(n,1), Fhat(n,2),alpha);  

dc_du0(n,1)=dc_du(Fhat(n,1), Fhat(n,2),alpha);  

dc_dv0(n,1)=dc_dv(Fhat(n,1), Fhat(n,2),alpha);  
end
end

